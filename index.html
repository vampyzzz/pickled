function showFinale() {
            state.isFinale = true;
            nextEpisodeBtn.classList.add('hidden');
            simulationScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');
            state.challengeLog.push('Finale');

            const finaleFormat = document.getElementById('finale').value;

            if (finaleFormat === 'top4' && state.currentCast.length === 4) {
                // "Top 4" finale logic
                state.currentCast.forEach(queen => queen.performanceScore = queen.getPerformance('Singing Challenge'));
                state.currentCast.sort((a, b) => (b.performanceScore + b.ppe) - (a.performanceScore + a.ppe));
                const lipSyncers = state.currentCast.slice(0, 2);
                const finalists = state.currentCast.slice(2);

                const winner = lipSyncers[0].getLipsyncPerformance() > lipSyncers[1].getLipsyncPerformance() ? lipSyncers[0] : lipSyncers[1];
                const runnerUp = lipSyncers.find(q => q.name !== winner.name);

                winner.addToTrackRecord("WINNER");
                runnerUp.addToTrackRecord("RUNNER-UP");
                finalists.forEach(q => q.addToTrackRecord("SEMI-FINALS"));

                state.eliminatedCast.push(runnerUp, ...finalists);
                state.currentCast = [winner];

            } else if (finaleFormat === 'top3' && state.currentCast.length === 3) {
                // "Top 3" finale logic
                state.currentCast.forEach(queen => queen.performanceScore = queen.getPerformance('Music Video Challenge'));
                state.currentCast.sort((a, b) => (b.performanceScore + b.ppe) - (a.performanceScore + a.ppe));
                const eliminatedQueen = state.currentCast.pop();
                const lipSyncers = state.currentCast;

                const winner = lipSyncers[0].getLipsyncPerformance() > lipSyncers[1].getLipsyncPerformance() ? lipSyncers[0] : lipSyncers[1];
                const runnerUp = lipSyncers.find(q => q.name !== winner.name);

                winner.addToTrackRecord("WINNER");
                runnerUp.addToTrackRecord("RUNNER-UP");
                eliminatedQueen.addToTrackRecord("ELIM");

                state.eliminatedCast.push(runnerUp, eliminatedQueen);
                state.currentCast = [winner];
            } else {
                // Fallback to original finale logic
                if (state.currentCast.length >= 4) {
                    state.currentCast.sort((a,b) => b.wins - a.wins || b.ppe - a.ppe); 
                    const semifinal1 = [state.currentCast[0], state.currentCast[3]];
                    const semifinal2 = [state.currentCast[1], state.currentCast[2]];

                    const winner1 = semifinal1[0].getLipsyncPerformance() > semifinal1[1].getLipsyncPerformance() ? semifinal1[0] : semifinal1[1];
                    const winner2 = semifinal2[0].getLipsyncPerformance() > semifinal2[1].getLipsyncPerformance() ? semifinal2[0] : semifinal2[1];
                    
                    const winner = winner1.getLipsyncPerformance() > winner2.getLipsyncPerformance() ? winner1 : winner2;
                    const runnerUp = winner === winner1 ? winner2 : winner1;

                    const semiFinalists = state.currentCast.filter(q => q.name !== winner.name && q.name !== runnerUp.name);

                    winner.addToTrackRecord("WINNER");
                    runnerUp.addToTrackRecord("RUNNER-UP");
                    semiFinalists.forEach(q => q.addToTrackRecord("SEMI-FINALS"));

                    state.eliminatedCast.push(...[runnerUp, ...semiFinalists].sort((a,b) => b.ppe - a.ppe));
                    state.currentCast = [winner];
                } else { 
                    state.currentCast.sort((a,b) => b.performanceScore - a.performanceScore);
                    const winner = state.currentCast[0];
                    const runnerUps = state.currentCast.slice(1);
                    winner.addToTrackRecord("WINNER");
                    runnerUps.forEach(q => q.addToTrackRecord("RUNNER-UP"));
                    state.eliminatedCast.push(...runnerUps);
                    state.currentCast = [winner];
                }
            }
            
            const winner = state.currentCast[0];
            winnerDisplay.innerHTML = `<div class="text-center">
                <h3 class="text-5xl font-bold text-yellow-400 mb-4" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.2);">And the winner is...</h3>
                <img src="${winner.image}" class="w-48 h-48 rounded-full mx-auto border-4 border-yellow-400 shadow-2xl">
                <p class="text-4xl font-bold mt-4">${winner.name}!</p>
                <p class="text-xl text-gray-500 mt-2">Condragulations, you're a winner, baby!</p>
            </div>`;
            
            renderTrackRecord();
        }
